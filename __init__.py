import os

# Configure PyTorch memory settings before any CUDA initialization
os.environ.setdefault(
    "PYTORCH_CUDA_ALLOC_CONF",
    "max_split_size_mb:256,garbage_collection_threshold:0.8,expandable_segments:True",
)

from .nodes import NODE_CLASS_MAPPINGS, NODE_DISPLAY_NAME_MAPPINGS
from .gpu_config_node import GPU_NODE_CLASS_MAPPINGS, GPU_NODE_DISPLAY_NAME_MAPPINGS
from .video_length_adjuster_node import VIDEO_NODE_CLASS_MAPPINGS, VIDEO_NODE_DISPLAY_NAME_MAPPINGS
from .video_loader_node import VIDEO_LOADER_NODE_CLASS_MAPPINGS, VIDEO_LOADER_NODE_DISPLAY_NAME_MAPPINGS
from .copy_video_node import COPY_VIDEO_NODE_CLASS_MAPPINGS, COPY_VIDEO_NODE_DISPLAY_NAME_MAPPINGS

# Merge the mappings
NODE_CLASS_MAPPINGS.update(GPU_NODE_CLASS_MAPPINGS)
NODE_DISPLAY_NAME_MAPPINGS.update(GPU_NODE_DISPLAY_NAME_MAPPINGS)
NODE_CLASS_MAPPINGS.update(VIDEO_NODE_CLASS_MAPPINGS)
NODE_DISPLAY_NAME_MAPPINGS.update(VIDEO_NODE_DISPLAY_NAME_MAPPINGS)
NODE_CLASS_MAPPINGS.update(VIDEO_LOADER_NODE_CLASS_MAPPINGS)
NODE_DISPLAY_NAME_MAPPINGS.update(VIDEO_LOADER_NODE_DISPLAY_NAME_MAPPINGS)
NODE_CLASS_MAPPINGS.update(COPY_VIDEO_NODE_CLASS_MAPPINGS)
NODE_DISPLAY_NAME_MAPPINGS.update(COPY_VIDEO_NODE_DISPLAY_NAME_MAPPINGS)

__all__ = ['NODE_CLASS_MAPPINGS', 'NODE_DISPLAY_NAME_MAPPINGS']